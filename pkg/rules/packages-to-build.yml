# This matrix definition is used as both the package_build_rules and the
# package_test_rules Ploutos packaging workflow inputs.
---
pkg:
  - "rtrtr"
image:
  - "ubuntu:jammy"    # ubuntu/22.04
  - "ubuntu:noble"    # ubuntu/24.04
  - "debian:bullseye" # debian/11
  - "debian:bookworm" # debian/12
  - "debian:trixie"   # debian/13
  - 'almalinux:8'    # compatible with EOL centos:8
  - 'almalinux:9'
  - 'almalinux:10'
target:
  - 'x86_64'
test-image:
  - ""
include:
  - image: 'almalinux:8'
    systemd_service_unit_file: pkg/common/rtrtr.rtrtr.service

  - image: 'almalinux:9'
    systemd_service_unit_file: pkg/common/rtrtr.rtrtr.service

  - image: 'almalinux:10'
    systemd_service_unit_file: pkg/common/rtrtr.rtrtr.service

  # package for the Raspberry Pi 4b as an ARMv7 cross compiled variant of the Debian Trixie upon which
  # Raspbian 13 is based.
  - pkg: 'rtrtr'
    image: 'debian:trixie'
    target: 'armv7-unknown-linux-musleabihf'
    test-image: 'debian:trixie/armhf'

  # package for the Raspberry Pi 4b 64-bit cross compiled variant of the Debian Trixie upon which
  # Raspbian 13 is based.
  - pkg: 'rtrtr'
    image: 'debian:trixie'
    target: 'aarch64-unknown-linux-musl'

  # package for the Raspberry Pi 4b as an ARMv7 cross compiled variant of the Debian Bookworm upon which
  # Raspbian 12 is based.
  - pkg: 'rtrtr'
    image: 'debian:bookworm'
    target: 'armv7-unknown-linux-musleabihf'
    test-image: 'debian:bookworm/armhf'

  # package for the Raspberry Pi 4b 64-bit cross compiled variant of the Debian Bookworm upon which
  # Raspbian 12 is based.
  - pkg: 'rtrtr'
    image: 'debian:bookworm'
    target: 'aarch64-unknown-linux-musl'

  # package for the Raspberry Pi 4b as an ARMv7 cross compiled variant of the Debian Bullseye upon which
  # Raspbian 11 is based.
  - pkg: 'rtrtr'
    image: 'debian:bullseye'
    target: 'armv7-unknown-linux-musleabihf'

  # package for the Raspberry Pi 1b as an ARMv6 cross compiled variant of the Debian Buster upon which
  # Raspbian 10 is based.
  - pkg: 'rtrtr'
    image: 'debian:buster'
    target: 'arm-unknown-linux-musleabihf'

  # package for the ROCK64 as an AARCH64 cross compiled variant of Debian Buster upon which Armbian 21 is based.
  - pkg: 'rtrtr'
    image: 'debian:buster'
    target: 'aarch64-unknown-linux-musl'

test-mode:   
  - 'fresh-install'
  - 'upgrade-from-published'

test-exclude:
  - pkg: 'rtrtr'
    image: 'ubuntu:noble'
    mode: 'upgrade-from-published'
  - pkg: 'rtrtr'
    image: 'almalinux:10'
    mode: 'upgrade-from-published'
  - pkg: 'rtrtr'
    image: 'debian:trixie'
    mode: 'upgrade-from-published'

